var wppaFileUrls={};function docReady(e){"complete"===document.readyState||"interactive"===document.readyState?setTimeout(e,1):document.addEventListener("DOMContentLoaded",e)}function uploadFile(e){let t=new FormData;t.append("file",e,e.name),t.append("action","wppaUploadFile");let n=new XMLHttpRequest;n.open("POST","//"+window.location.host+"/wp-admin/admin-ajax.php",!0),n.onload=function(){if(this.status>=200&&this.status<400){let t=this.response;null!=t&&""!=t&&(wppaFileUrls[e.name]=t,document.getElementById("pdfFilesContainer").innerHTML+='<li class="file-item" id="attachment_'+t+'"><i class="far fa-file"></i><input class="filename-controller" data-filename="'+e.name+'" type="text" value="'+e.name.substring(0,15)+(e.name.length>15?"[...]":"")+'"></input><div class="action-btns"><a class="link-btn" href="'+t+'" target="blank" rel="noopener noreferrer"><i class="fas fa-link"></i></a><i data-name="'+e.name+'" data-url="'+t+'" class="fas fa-times remove-btn"></i></div></li>',document.getElementById("wppa_attachment_list").value=JSON.stringify(wppaFileUrls))}else console.log("Internal Server Error!\n"+this.response)},n.onerror=function(){console.log("Request error...")},n.send(t)}docReady(function(){if(document.getElementById("wppa_attachment")){let e=document.getElementById("wppa_attachment");e.addEventListener("change",function(){uploadFile(e.files[0])})}if(document.getElementById("wppa_attachment_list")){let e=document.getElementById("wppa_attachment_list_value").innerHTML;null!=e&&""!=e&&(wppaFileUrls=JSON.parse(e))}document.addEventListener("change",function(e){for(var t=e.target;t&&t!=this;t=t.parentNode)t.matches(".filename-controller")&&(wppaFileUrls[t.value]=wppaFileUrls[t.getAttribute("data-filename")],delete wppaFileUrls[t.getAttribute("data-filename")],document.getElementById("wppa_attachment_list").value=JSON.stringify(wppaFileUrls))}),document.addEventListener("click",function(e){for(var t=e.target;t&&t!=this;t=t.parentNode)if(t.matches(".remove-btn")){let e=t.getAttribute("data-name"),n=t.getAttribute("data-url");delete wppaFileUrls[e],document.getElementById("attachment_"+n).remove(),document.getElementById("wppa_attachment_list").value=JSON.stringify(wppaFileUrls)}})});
